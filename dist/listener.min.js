window.jsTracker.prototype._getOS=function(){var e="Unknown OS";return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e},window.jsTracker.prototype._getInnerSize=function(){return window.innerWidth+" x "+window.innerHeight},window.jsTracker.prototype._getSize=function(){return screen.width+" x "+screen.height},window.jsTracker.prototype._getUserAgent=function(){return navigator.userAgent},window.jsTracker.prototype._getBrowser=function(){var e,n=navigator.userAgent,r=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(e=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:e[1]||""}):"Chrome"===r[1]&&(e=n.match(/\bOPR\/(\d+)/),null!=e)?{name:"Opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=n.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),r[0]+" "+r[1])},window.jsTracker.prototype._loadFile=function(e,n){console.trackjs("jsTracker _loadFile",e);var r=new Promise(function(n,r){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&(200===t.status?n(t.responseText):r(t.status+": "+t.statusText))},t.open("GET",e,!0),t.send()});return r},window.jsTracker.prototype.getDetails=function(){return{os:this._getOS(),userAgent:this._getUserAgent(),screenSize:this._getSize(),screenInnerSize:this._getInnerSize(),location:window.location.href,browser:this._getBrowser()}},window.jsTracker.prototype.getToken=function(){var e=window.document.getElementsByTagName("script");for(var n in e)if(e[n].src){var r=e[n].src.split("?").pop().split("&"),t={};for(var o in r){var a=r[o].split("=");t[a[0]]=a[1]}if(t.token)return t.token}console.error("undefined TrackJS Token")},window.jsTracker.prototype.initHooks=function(){console.log("jsTracker initHooks");var e=this;window.addEventListener("error",function(n){e.onError("js",n)}),"undefined"!=typeof angular&&angular.module("jsTracker",[]).config(function(n){console.trackjs("jsTracker $exceptionHandler"),n.decorator("$exceptionHandler",function(n){return function(r,t){e.onError("angular",r),n(r,t)}})}).config(function(n,r){console.trackjs("jsTracker $logProvider"),n.debugEnabled(!1),r.decorator("$log",function(n){var r=n.info,t=n.log,o=n.debug,a=n.warn,i=n.error;return n.info=function(){e.console.add("info",arguments),r.apply(null,arguments)},n.error=function(){e.console.add("error",arguments),i.apply(null,arguments)},n.warn=function(){e.console.add("warn",arguments),a.apply(null,arguments)},n.debug=function(){e.console.add("debug",arguments),o.apply(null,arguments)},n.log=function(){e.console.add("log",arguments),t.apply(null,arguments)},n})}).config(function(n){console.trackjs("jsTracker $httpProvider"),n.interceptors.push(function(n){return{responseError:function(r){return e.onError("ajax",r),n.reject(r)}}})})},window.jsTracker=function(){console.log("jsTracker init"),this.initHooks(),this.initConsole(),this.getToken()},window.jsTracker.prototype.onError=function(e,n){var r=new XMLHttpRequest;r.open("POST","https://api.parse.com/1/classes/Log",!0),r.setRequestHeader("X-Parse-Application-Id","Sxl3ayGGamC32hd6gbiCq6ctVo2Kl5ViaUVZOKqv"),r.setRequestHeader("X-Parse-REST-API-Key","WVryeQAhXtWpJCBYo8iuHgBQQzFxQRl4N1lAfsLR"),r.setRequestHeader("Content-Type","application/json"),this.getInfo(e,n).then(function(e){r.send(JSON.stringify(e))})},window.jsTracker.prototype.getInfo=function(e,n){console.trackjs("jsTracker getInfo");var r=this.getDetails(),t=this;return t.getToken().then(function(o){switch(r.type=e,r.domain=window.document.location.hostname,r.instanceId={__type:"Pointer",className:"Instance",objectId:o},r.console=t.console.get(),e){case"js":n.error&&n.error.stack&&(r.stack=String(n.error.stack).replace(/(?:\r\n|\r|\n)/g,"<br />")),console.trackjs(n),r.info={line:n.lineno,column:n.colno,message:n.message,filename:n.filename};break;case"angular":r.stack=String(n.stack).replace(/(?:\r\n|\r|\n)/g,"<br />");var a=String(n.stack).split(/\r\n?|\n/)[1].match(/\http([-a-zA-Z0-9@:%._\+~#=\/]+)/g)[0];r.info=function(e){function r(e){var n=e.match(/(\d+)/g);return Number(n[n.length-2])}function t(e){var n=e.match(/(\w+)/g);return Number(n[n.length-1])}function o(e){return e.match(/([a-z]{1,5}[:][-a-zA-Z0-9._\/]+)[:]([-a-zA-Z0-9@%._\+~#=\/]+)/g)[0]}return{line:r(e),column:t(e),message:n.message,filename:o(e)}}(a);break;case"ajax":r.info={message:n.config.method+" "+n.config.url+": "+n.status+" "+n.statusText,method:n.config.method,params:n.config.params,headers:n.config.headers,url:n.config.url,data:n.data,status:n.status,statusText:n.statusText};break;case"jquery":}return r.info=r.info||{},r.cookie=window.document.cookie,r.localStorage=function(){for(var e=[],n=0,r=window.localStorage.length;r>n;++n){var t=window.localStorage.key(n),o=window.localStorage.getItem(t),a={key:t.replace(/$-./g,"")};try{a.data=JSON.parse(o)}catch(i){a.data=o}e.push(a)}return e}(),r.info.filename?t._loadFile(r.info.filename).then(function(e){var n=String(e).split(/\r\n?|\n/);if(n.length>20){var t=r.info.line,o=t-11,a=t+11;n=n.slice(o,a),r.file=n.join("\r\n")}return r},function(e){console.error("Could not find file",e)}):new Promise(function(e,n){e(r)})})},window.jsTracker=new jsTracker,window.jsTracker.prototype.initConsole=function(){console.log("jsTracker initConsole");var e=function(){this.events=[],this.setProxy()};e.prototype={setProxy:function(){console.log("jsTracker","setProxy");var e=["assert","clear","count","debug","dir","dirxml","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"];console.trackjs=function(){return console.log}();var n=this;for(var r in e)console[e[r]]=function(e,r){return function(t){n.add(e,arguments),r.apply(this,arguments)}}(e[r],console[e[r]])},get:function(){return this.events},add:function(e,n){this.events.push({method:e,message:n})}},this.console=new e};